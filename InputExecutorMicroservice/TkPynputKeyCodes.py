from __future__ import annotations

import inspect

import pynput.keyboard
from PySide6.QtCore import Qt
from PySide6.QtWidgets import QWidget
from pynput.keyboard import Key
from typing import Optional


class KeyTranslator:
    MAPPED_KEYS = {
        16777216: Qt.Key.Key_Escape,
        16777217: Qt.Key.Key_Tab,
        16777218: Qt.Key.Key_Backtab,
        16777219: Qt.Key.Key_Backspace,
        16777220: Qt.Key.Key_Return,
        16777221: Qt.Key.Key_Enter,
        16777222: Qt.Key.Key_Insert,
        16777223: Qt.Key.Key_Delete,
        16777224: Qt.Key.Key_Pause,
        16777225: Qt.Key.Key_Print,
        16777226: Qt.Key.Key_SysReq,
        16777227: Qt.Key.Key_Clear,
        16777232: Qt.Key.Key_Home,
        16777233: Qt.Key.Key_End,
        16777234: Qt.Key.Key_Left,
        16777235: Qt.Key.Key_Up,
        16777236: Qt.Key.Key_Right,
        16777237: Qt.Key.Key_Down,
        16777238: Qt.Key.Key_PageUp,
        16777239: Qt.Key.Key_PageDown,
        16777248: Qt.Key.Key_Shift,
        16777249: Qt.Key.Key_Control,
        16777250: Qt.Key.Key_Meta,
        16777251: Qt.Key.Key_Alt,
        16777252: Qt.Key.Key_CapsLock,
        16777253: Qt.Key.Key_NumLock,
        16777254: Qt.Key.Key_ScrollLock,
        16777264: Qt.Key.Key_F1,
        16777265: Qt.Key.Key_F2,
        16777266: Qt.Key.Key_F3,
        16777267: Qt.Key.Key_F4,
        16777268: Qt.Key.Key_F5,
        16777269: Qt.Key.Key_F6,
        16777270: Qt.Key.Key_F7,
        16777271: Qt.Key.Key_F8,
        16777272: Qt.Key.Key_F9,
        16777273: Qt.Key.Key_F10,
        16777274: Qt.Key.Key_F11,
        16777275: Qt.Key.Key_F12,
        16777276: Qt.Key.Key_F13,
        16777277: Qt.Key.Key_F14,
        16777278: Qt.Key.Key_F15,
        16777279: Qt.Key.Key_F16,
        16777280: Qt.Key.Key_F17,
        16777281: Qt.Key.Key_F18,
        16777282: Qt.Key.Key_F19,
        16777283: Qt.Key.Key_F20,
        16777284: Qt.Key.Key_F21,
        16777285: Qt.Key.Key_F22,
        16777286: Qt.Key.Key_F23,
        16777287: Qt.Key.Key_F24,
        16777288: Qt.Key.Key_F25,
        16777289: Qt.Key.Key_F26,
        16777290: Qt.Key.Key_F27,
        16777291: Qt.Key.Key_F28,
        16777292: Qt.Key.Key_F29,
        16777293: Qt.Key.Key_F30,
        16777294: Qt.Key.Key_F31,
        16777295: Qt.Key.Key_F32,
        16777296: Qt.Key.Key_F33,
        16777297: Qt.Key.Key_F34,
        16777298: Qt.Key.Key_F35,
        16777299: Qt.Key.Key_Super_L,
        16777300: Qt.Key.Key_Super_R,
        16777301: Qt.Key.Key_Menu,
        16777302: Qt.Key.Key_Hyper_L,
        16777303: Qt.Key.Key_Hyper_R,
        16777304: Qt.Key.Key_Help,
        16777305: Qt.Key.Key_Direction_L,
        16777312: Qt.Key.Key_Direction_R,
        32: Qt.Key.Key_Space,
        33: Qt.Key.Key_Exclam,
        34: Qt.Key.Key_QuoteDbl,
        35: Qt.Key.Key_NumberSign,
        36: Qt.Key.Key_Dollar,
        37: Qt.Key.Key_Percent,
        38: Qt.Key.Key_Ampersand,
        39: Qt.Key.Key_Apostrophe,
        40: Qt.Key.Key_ParenLeft,
        41: Qt.Key.Key_ParenRight,
        42: Qt.Key.Key_Asterisk,
        43: Qt.Key.Key_Plus,
        44: Qt.Key.Key_Comma,
        45: Qt.Key.Key_Minus,
        46: Qt.Key.Key_Period,
        47: Qt.Key.Key_Slash,
        48: Qt.Key.Key_0,
        49: Qt.Key.Key_1,
        50: Qt.Key.Key_2,
        51: Qt.Key.Key_3,
        52: Qt.Key.Key_4,
        53: Qt.Key.Key_5,
        54: Qt.Key.Key_6,
        55: Qt.Key.Key_7,
        56: Qt.Key.Key_8,
        57: Qt.Key.Key_9,
        58: Qt.Key.Key_Colon,
        59: Qt.Key.Key_Semicolon,
        60: Qt.Key.Key_Less,
        61: Qt.Key.Key_Equal,
        62: Qt.Key.Key_Greater,
        63: Qt.Key.Key_Question,
        64: Qt.Key.Key_At,
        65: Qt.Key.Key_A,
        66: Qt.Key.Key_B,
        67: Qt.Key.Key_C,
        68: Qt.Key.Key_D,
        69: Qt.Key.Key_E,
        70: Qt.Key.Key_F,
        71: Qt.Key.Key_G,
        72: Qt.Key.Key_H,
        73: Qt.Key.Key_I,
        74: Qt.Key.Key_J,
        75: Qt.Key.Key_K,
        76: Qt.Key.Key_L,
        77: Qt.Key.Key_M,
        78: Qt.Key.Key_N,
        79: Qt.Key.Key_O,
        80: Qt.Key.Key_P,
        81: Qt.Key.Key_Q,
        82: Qt.Key.Key_R,
        83: Qt.Key.Key_S,
        84: Qt.Key.Key_T,
        85: Qt.Key.Key_U,
        86: Qt.Key.Key_V,
        87: Qt.Key.Key_W,
        88: Qt.Key.Key_X,
        89: Qt.Key.Key_Y,
        90: Qt.Key.Key_Z,
        91: Qt.Key.Key_BracketLeft,
        92: Qt.Key.Key_Backslash,
        93: Qt.Key.Key_BracketRight,
        94: Qt.Key.Key_AsciiCircum,
        95: Qt.Key.Key_Underscore,
        96: Qt.Key.Key_QuoteLeft,
        123: Qt.Key.Key_BraceLeft,
        124: Qt.Key.Key_Bar,
        125: Qt.Key.Key_BraceRight,
        126: Qt.Key.Key_AsciiTilde,
    }

    keys = {
        Qt.Key_Alt: Key.alt,
        # _: Key.alt_gr,
        # _: Key.alt_r,
        Qt.Key_Backspace: Key.backspace,
        Qt.Key_CapsLock: Key.caps_lock,
        Qt.Key_Super_L: Key.cmd,
        Qt.Key_Super_R: Key.cmd_r,
        Qt.Key_Control: Key.ctrl,
        #_: Key.ctrl_r,
        Qt.Key_Delete: Key.delete,
        Qt.Key_Down: Key.down,
        Qt.Key_End: Key.end,
        Qt.Key_Enter: Key.enter,
        Qt.Key_Return: Key.enter,
        Qt.Key_Escape: Key.esc,
        Qt.Key_F1: Key.f1,
        Qt.Key_F10: Key.f10,
        Qt.Key_F11: Key.f11,
        Qt.Key_F12: Key.f12,
        Qt.Key_F13: Key.f13,
        Qt.Key_F14: Key.f14,
        Qt.Key_F15: Key.f15,
        Qt.Key_F16: Key.f16,
        Qt.Key_F17: Key.f17,
        Qt.Key_F18: Key.f18,
        Qt.Key_F19: Key.f19,
        Qt.Key_F2: Key.f2,
        Qt.Key_F20: Key.f20,
        Qt.Key_F3: Key.f3,
        Qt.Key_F4: Key.f4,
        Qt.Key_F5: Key.f5,
        Qt.Key_F6: Key.f6,
        Qt.Key_F7: Key.f7,
        Qt.Key_F8: Key.f8,
        Qt.Key_F9: Key.f9,
        Qt.Key_Home: Key.home,
        Qt.Key_Insert: Key.insert,
        Qt.Key_Left: Key.left,
        Qt.Key_MediaNext: Key.media_next,
        Qt.Key_MediaPause: Key.media_play_pause,
        Qt.Key_MediaPrevious: Key.media_previous,
        Qt.Key_VolumeDown: Key.media_volume_down,
        Qt.Key_VolumeMute: Key.media_volume_mute,
        Qt.Key_VolumeUp: Key.media_volume_up,
        Qt.Key_Menu: Key.menu,
        Qt.Key_NumLock: Key.num_lock,
        Qt.Key_PageDown: Key.page_down,
        Qt.Key_PageUp: Key.page_up,
        Qt.Key_Pause: Key.pause,
        Qt.Key_Print: Key.print_screen,
        Qt.Key_Right: Key.right,
        Qt.Key_ScrollLock: Key.scroll_lock,
        Qt.Key_Shift: Key.shift,
        #Qt.Key_Shif: Key.shift_r,
        Qt.Key_Space: Key.space,
        Qt.Key_Tab: Key.tab,
        Qt.Key_Up: Key.up,
    }

    @staticmethod
    def translate(keycode: int) -> Optional[Key | str]:
        result = None
        if keycode:
            result = KeyTranslator.MAPPED_KEYS.get(keycode, None)

        if result is not None:
            return KeyTranslator.keys.get(result, None)
        else:
            return chr(keycode)


if __name__ == "__main__":
    attributes = inspect.getmembers(pynput.keyboard.Key, lambda a: not (inspect.isroutine(a)))
    l = [str(a[1]) for a in attributes if not (a[0].startswith('__') and a[0].endswith('__'))]
    l = [e for e in l if e.startswith("Key")]
    for elem in l:
        print(f"_ :{elem},")
